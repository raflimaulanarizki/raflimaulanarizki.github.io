---
layout: post
title: Backup Automatically Junos OS
date: 2023-10-30
pin: 
tags: juniper network
splash_img_source: /assets/img/mikrotik-openvpn.png
splash_img_caption: 
---

# Backup Automatically Junos OS

Owner: Muhamad Rafli Maulana Rizki
Tags: Policies
Created time: October 13, 2023 1:43 PM

Konfigrasi Backup Automatic menggunakan FTP server, 

sebelumnya saya sudah membuat konfigurasi Backup manual berikut linknya 

## Set Clock

Pastikan Waktu sudah sesuai, karena format file menggunakan Tanggal dan waktu.

```visual-basic
#show time 
*user@host> show system uptime 
user@host# set system time-zone Asia/Jakarta #Set Timezone*

#jika belum sesuai, bisa di set manual.
*user@host> set date 202310131309* 
```

## Backup Manual

```bash
save SW.HOME_13Okt23
file list
file copy SW.JUNOS.OPENRACK-13okt ftp://chroot@202.182.57.52/switch/SW-JUNOS-MMR-APJII/
```

## Set Event-Options

Membuat Scheduler, Action and Destination.

### Generate Event

Create Schedule (Event), [https://www.juniper.net/documentation/us/en/software/junos/automation-scripting/topics/ref/statement/generate-event-edit-event-options.html](https://www.juniper.net/documentation/us/en/software/junos/automation-scripting/topics/ref/statement/generate-event-edit-event-options.html)

```visual-basic
*user@host#* set event-options generate-event Backup-Daily_event time-of-day "00:00:05 +0700"
#Command
*Backup-Daily_event* : Nama Event
time-of-day        : Daily event / setiap hari
"00:00:05 +0700"   : Waktu executed event
```

set policy Backup-Daily_police events Backup-Daily_event
set policy Backup-Daily_police then upload filename /config/juniper.conf.gz destination ftp_server

set destinations ftp_server archive-sites [ftp://chroot@202.182.57.52/switch/](ftp://chroot@202.182.57.52/switch/SW-JUNOS-SP226/) password test112233

set generate-event Backup-Daily_event time-of-day "13:05:00 +0700"

delete destinations ftp_server archive-sites
set destinations ftp_server archive-sites [ftp://chroot@202.182.57.52/switch/SW-JUNOS-MMR-APJII/](ftp://chroot@202.182.57.52/switch/SW-JUNOS-MMR-APJII/) password test112233

set destinations ftp_server archive-sites [ftp://chroot:abc123@202.182.57.52/switch/](ftp://chroot:susujandam4h4L@202.182.57.52/switch/SW-JUNOS-SP226/)

```visual-basic
event-options {
    generate-event {
        Backup-Daily_event time-of-day "00:00:10 +0700";
    }
    policy Backup-Daily_police {
        events Backup-Daily_event;
        then {
            upload filename /config/juniper.conf.gz destination ftp_server;
        }
    }
    destinations {
        ftp_server {
            archive-sites {
                "ftp://chroot@202.182.57.52/switch/SW-JUNOS-OPENRACK/" password "$9$DDkfz9A0Ihr0BeWLXbwHqmP5Fn6ABIcAtEyreW82go"; ## SECRET-DATA
            }
        }
    }
}
```